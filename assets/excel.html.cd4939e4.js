import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";import{o as r,c as k,b as n,d as a,w as t,e as s,a as d,r as p}from"./app.723e4bbf.js";var v="/vuepress/vue2-excel-1.png";const m={},b=n("h1",{id:"excel-\u65B9\u6848",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#excel-\u65B9\u6848","aria-hidden":"true"},"#"),s(" Excel \u65B9\u6848")],-1),y=n("h2",{id:"\u901A\u8FC7-exceljs-\u5B9E\u73B0\u7EAF\u524D\u7AEF\u590D\u6742-excel-\u5BFC\u51FA",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u901A\u8FC7-exceljs-\u5B9E\u73B0\u7EAF\u524D\u7AEF\u590D\u6742-excel-\u5BFC\u51FA","aria-hidden":"true"},"#"),s(" \u901A\u8FC7 ExcelJS \u5B9E\u73B0\u7EAF\u524D\u7AEF\u590D\u6742 excel \u5BFC\u51FA")],-1),g={href:"https://github.com/exceljs/exceljs/blob/master/README_zh.md",target:"_blank",rel:"noopener noreferrer"},q=s("\u6587\u6863\u5730\u5740"),w={class:"custom-container info"},h=n("p",{class:"custom-container-title"},"\u5B89\u88C5",-1),f=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token function"},"yarn"),s(),n("span",{class:"token function"},"add"),s(` exceljs
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),x=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token function"},"npm"),s(),n("span",{class:"token function"},"install"),s(` exceljs
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),_=d('<h2 id="\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u793A\u4F8B" aria-hidden="true">#</a> \u793A\u4F8B</h2><p>\u7ED3\u679C:</p><p><img src="'+v+`" alt="vue2-excel-1" loading="lazy"></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// download-excel.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> saveAs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;file-saver&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">saveWorkbook</span><span class="token punctuation">(</span><span class="token parameter">workbook<span class="token punctuation">,</span> fileName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5BFC\u51FA\u6587\u4EF6</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">saveAs</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u4E1A\u52A1\u4EE3\u7801</span>

<span class="token comment">// \u521B\u5EFA\u5DE5\u4F5C\u7C3F</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u521B\u5EFA\u5E26\u6709\u7EA2\u8272\u6807\u7B7E\u989C\u8272\u7684\u5DE5\u4F5C\u8868</span>
<span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">views</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">&quot;frozen&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">xSplit</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token literal-property property">ySplit</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u8868\u5934</span>
<span class="token keyword">const</span> headerRows <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span>
    <span class="token string">&quot;\u83CC\u682A\u540D\u79F0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6837\u672C\u5E8F\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6837\u672C\u7C7B\u578B&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u83CC\u682A\u7F16\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6279\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6765\u6E90\u5730&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u5165\u5E93\u72B6\u6001&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6297\u751F\u7D20&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">&quot;\u83CC\u682A\u540D\u79F0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6837\u672C\u5E8F\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6837\u672C\u7C7B\u578B&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u83CC\u682A\u7F16\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6279\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6765\u6E90\u5730&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u5165\u5E93\u72B6\u6001&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6297\u751F\u7D20&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">&quot;\u83CC\u682A\u540D\u79F0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6837\u672C\u5E8F\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6837\u672C\u7C7B\u578B&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u83CC\u682A\u7F16\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6279\u53F7&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6765\u6E90\u5730&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u5165\u5E93\u72B6\u6001&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6297\u751F\u7D20&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// \u6DFB\u52A0\u8868\u5934</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> methodologies <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>validMethodologies<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> methodologyName <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> experimentDate <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> methodologies<span class="token punctuation">;</span>
  headerRows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>methodologyName<span class="token punctuation">,</span> methodologyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  headerRows<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>experimentDate<span class="token punctuation">,</span> experimentDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  headerRows<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;MIC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SIR&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

sheet1<span class="token punctuation">.</span><span class="token function">addRows</span><span class="token punctuation">(</span>headerRows<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u6DFB\u52A0 \u6570\u636E\u884C</span>
<span class="token keyword">const</span> dataRows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> row <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectedRows<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> storeState <span class="token operator">=</span>
    row<span class="token punctuation">.</span>storeState <span class="token operator">===</span> <span class="token number">1</span>
      <span class="token operator">?</span> <span class="token string">&quot;\u5DF2\u5165\u5E93&quot;</span>
      <span class="token operator">:</span> row<span class="token punctuation">.</span>storeState <span class="token operator">===</span> <span class="token number">0</span>
      <span class="token operator">?</span> <span class="token string">&quot;\u5F85\u5165\u5E93&quot;</span>
      <span class="token operator">:</span> <span class="token string">&quot;\u672A\u5165\u5E93&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> crow <span class="token operator">=</span> <span class="token punctuation">[</span>
    row<span class="token punctuation">.</span>getName<span class="token punctuation">,</span>
    row<span class="token punctuation">.</span>sampleNo<span class="token punctuation">,</span>
    row<span class="token punctuation">.</span>sampleType<span class="token punctuation">,</span>
    row<span class="token punctuation">.</span>sourceNo<span class="token punctuation">,</span>
    row<span class="token punctuation">.</span>sourceLotNo<span class="token punctuation">,</span>
    row<span class="token punctuation">.</span>sourceAddr<span class="token punctuation">,</span>
    storeState<span class="token punctuation">,</span>
    row<span class="token punctuation">.</span>antibiotic<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> methodologies <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>validMethodologies<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> methodologyID<span class="token punctuation">,</span> experimentDate <span class="token punctuation">}</span> <span class="token operator">=</span> methodologies<span class="token punctuation">;</span>
    <span class="token keyword">const</span> frow <span class="token operator">=</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tableRawData<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token parameter">rawRow</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          rawRow<span class="token punctuation">.</span>getName <span class="token operator">===</span> row<span class="token punctuation">.</span>getName <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>sourceNo <span class="token operator">===</span> row<span class="token punctuation">.</span>sourceNo <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>sourceLotNo <span class="token operator">===</span> row<span class="token punctuation">.</span>sourceLotNo <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>sourceAddr <span class="token operator">===</span> row<span class="token punctuation">.</span>sourceAddr <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>storeState <span class="token operator">===</span> row<span class="token punctuation">.</span>storeState <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>antibiotic <span class="token operator">===</span> row<span class="token punctuation">.</span>antibiotic <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>methodologyID <span class="token operator">===</span> methodologyID <span class="token operator">&amp;&amp;</span>
          rawRow<span class="token punctuation">.</span>experimentDate <span class="token operator">===</span> experimentDate
      <span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    crow<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>frow<span class="token punctuation">.</span>micValue <span class="token operator">??</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> frow<span class="token punctuation">.</span>drugSusceptibilityExplanation <span class="token operator">??</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  dataRows<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>crow<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
sheet1<span class="token punctuation">.</span><span class="token function">addRows</span><span class="token punctuation">(</span>dataRows<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u8868\u5934\u524D 6 \u5217\u5408\u5E76</span>
sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">&quot;A1:A3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">&quot;B1:B3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">&quot;C1:C3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">&quot;D1:D3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">&quot;E1:E3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">&quot;F1:F3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u8868\u59346 \u5217\u4EE5\u540E \u4E24\u4E24\u5408\u5E76</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> idx <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>validMethodologies<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token operator">+</span> idx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token operator">+</span> idx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token operator">+</span> idx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token operator">+</span> idx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// \u8BBE\u7F6E\u6837\u5F0F</span>
sheet1<span class="token punctuation">.</span><span class="token function">eachRow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> cellNumber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(\`rowNumber \${rowNumber},cellNumber \${cellNumber}\`)</span>
    <span class="token comment">// \u8BBE\u7F6E\u524D\u4E09\u884C(\u8868\u5934) \u6837\u5F0F</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rowNumber <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">wrapText</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pattern&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">&quot;solid&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fgColor</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">&quot;FF008080&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      cell<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;thin&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">&quot;FFD3D3D3&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;thin&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">&quot;FFD3D3D3&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;thin&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">&quot;FFD3D3D3&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;thin&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">&quot;FFD3D3D3&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">&quot;FFFFFFFF&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u4E09\u884C\u4EE5\u540E \u6570\u636E\u884C\u7684\u6837\u5F0F</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cellNumber <span class="token operator">&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">wrapText</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cellNumber <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">wrapText</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// const rowStoreState = row.getCell(5).value</span>

      <span class="token comment">// const fgColor = rowStoreState === &#39;\u5DF2\u5165\u5E93&#39; ? &#39;1e008080&#39; : (rowStoreState === &#39;\u5F85\u5165\u5E93&#39; ? &#39;1ee6a23c&#39; : &#39;1ef56c6c&#39;)</span>

      <span class="token comment">// cell.fill = {</span>
      <span class="token comment">//   type: &#39;pattern&#39;,</span>
      <span class="token comment">//   pattern: &#39;solid&#39;,</span>
      <span class="token comment">//   fgColor: { argb: fgColor }</span>
      <span class="token comment">// }</span>
      <span class="token comment">// cell.border = {</span>
      <span class="token comment">//   left: { style: &#39;thin&#39;, color: { argb: &#39;FFD3D3D3&#39; }},</span>
      <span class="token comment">//   bottom: { style: &#39;thin&#39;, color: { argb: &#39;FFD3D3D3&#39; }},</span>
      <span class="token comment">//   right: { style: &#39;thin&#39;, color: { argb: &#39;FFD3D3D3&#39; }}</span>
      <span class="token comment">// }</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u8BBE\u7F6E\u524D 6 \u5217 width</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">saveWorkbook</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.xlsx</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4);function D(N,F){const o=p("ExternalLinkIcon"),e=p("CodeTabs");return r(),k("div",null,[b,y,n("p",null,[n("a",g,[q,a(o)])]),n("div",w,[h,a(e,{data:[{title:"yarn"},{title:"npm"}],active:0,"tab-id":"bash"},{tab0:t(({title:c,value:l,isActive:i})=>[f]),tab1:t(({title:c,value:l,isActive:i})=>[x]),_:1})]),_])}var S=u(m,[["render",D],["__file","excel.html.vue"]]);export{S as default};
